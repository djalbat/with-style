"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.default = void 0;
var _style = _interopRequireDefault(require("../style"));
var _lexer = _interopRequireDefault(require("../css/lexer"));
var _parser = _interopRequireDefault(require("../css/parser"));
function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
var cssLexer = _lexer.default.fromNothing(), cssParser = _parser.default.fromNothing();
if (!globalThis.styleMap) {
    globalThis.styleMap = {
    };
}
var styleMap = globalThis.styleMap;
function renderStyle(style) {
    var headDOMElement = document.querySelector("head"), styleDOMElement = document.createElement("style"), innerHTML = "\n        \n".concat(style);
    Object.assign(styleDOMElement, {
        innerHTML: innerHTML
    });
    headDOMElement.appendChild(styleDOMElement);
}
function renderStyles() {
    var stylesCSS = retrieveStylesCSS(), style = stylesCSS; ///
    renderStyle(style);
}
function generateStyle(args, className, param) {
    var superStyle = param === void 0 ? null : param;
    var strings = args.shift(), content = strings.reduce(function(content1, string, index) {
        var arg = args[index];
        content1 = arg !== undefined ? "".concat(content1).concat(string).concat(arg) : "".concat(content1).concat(string);
        return content1;
    }, ""), tokens = cssLexer.tokenise(content), node = cssParser.parse(tokens), style = _style.default.fromNodeAndTokens(node, tokens);
    if (superStyle !== null) {
        style.extends(superStyle);
    }
    styleMap[className] = style;
}
function retrieveStyle(className) {
    var style = styleMap[className] || null;
    return style;
}
var _default = {
    renderStyle: renderStyle,
    renderStyles: renderStyles,
    generateStyle: generateStyle,
    retrieveStyle: retrieveStyle
};
exports.default = _default;
function retrieveStylesCSS() {
    var classNames = Object.keys(styleMap), stylesCSS = classNames.reduce(function(stylesCSS1, className) {
        var style = retrieveStyle(className), styleCSS = style.asCSS(className);
        stylesCSS1 += styleCSS;
        return stylesCSS1;
    }, "");
    return stylesCSS;
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsaXRpZXMvc3R5bGVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgU3R5bGUgZnJvbSBcIi4uL3N0eWxlXCI7XG5pbXBvcnQgQ1NTTGV4ZXIgZnJvbSBcIi4uL2Nzcy9sZXhlclwiO1xuaW1wb3J0IENTU1BhcnNlciBmcm9tIFwiLi4vY3NzL3BhcnNlclwiO1xuXG5jb25zdCBjc3NMZXhlciA9IENTU0xleGVyLmZyb21Ob3RoaW5nKCksXG4gICAgICBjc3NQYXJzZXIgPSBDU1NQYXJzZXIuZnJvbU5vdGhpbmcoKTtcblxuaWYgKCFnbG9iYWxUaGlzLnN0eWxlTWFwKSB7XG4gIGdsb2JhbFRoaXMuc3R5bGVNYXAgPSB7fTtcbn1cblxuY29uc3QgeyBzdHlsZU1hcCB9ID0gZ2xvYmFsVGhpcztcblxuZnVuY3Rpb24gcmVuZGVyU3R5bGUoc3R5bGUpIHtcbiAgY29uc3QgaGVhZERPTUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaGVhZFwiKSxcbiAgICAgICAgc3R5bGVET01FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpLFxuICAgICAgICBpbm5lckhUTUwgPSBgXG4gICAgICAgIFxuJHtzdHlsZX1gO1xuXG4gIE9iamVjdC5hc3NpZ24oc3R5bGVET01FbGVtZW50LCB7XG4gICAgaW5uZXJIVE1MXG4gIH0pO1xuXG4gIGhlYWRET01FbGVtZW50LmFwcGVuZENoaWxkKHN0eWxlRE9NRWxlbWVudCk7XG59XG5cbmZ1bmN0aW9uIHJlbmRlclN0eWxlcygpIHtcbiAgY29uc3Qgc3R5bGVzQ1NTID0gcmV0cmlldmVTdHlsZXNDU1MoKSxcbiAgICAgICAgc3R5bGUgPSBzdHlsZXNDU1M7ICAvLy9cblxuICByZW5kZXJTdHlsZShzdHlsZSk7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlU3R5bGUoYXJncywgY2xhc3NOYW1lLCBzdXBlclN0eWxlID0gbnVsbCkge1xuICBjb25zdCBzdHJpbmdzID0gYXJncy5zaGlmdCgpLFx0Ly8vXG4gICAgICAgIGNvbnRlbnQgPSBzdHJpbmdzLnJlZHVjZSgoY29udGVudCwgc3RyaW5nLCBpbmRleCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGFyZyA9IGFyZ3NbaW5kZXhdO1xuXG4gICAgICAgICAgY29udGVudCA9IChhcmcgIT09IHVuZGVmaW5lZCkgP1xuICAgICAgICAgICAgICAgICAgICAgIGAke2NvbnRlbnR9JHtzdHJpbmd9JHthcmd9YCA6XG4gICAgICAgICAgICAgICAgICAgICAgICBgJHtjb250ZW50fSR7c3RyaW5nfWA7XG5cbiAgICAgICAgICByZXR1cm4gY29udGVudDtcbiAgICAgICAgfSwgXCJcIiksXG4gICAgICAgIHRva2VucyA9IGNzc0xleGVyLnRva2VuaXNlKGNvbnRlbnQpLFxuICAgICAgICBub2RlID0gY3NzUGFyc2VyLnBhcnNlKHRva2VucyksXG4gICAgICAgIHN0eWxlID0gU3R5bGUuZnJvbU5vZGVBbmRUb2tlbnMobm9kZSwgdG9rZW5zKTtcblxuICAgICAgICBpZiAoc3VwZXJTdHlsZSAhPT0gbnVsbCkge1xuICAgICAgICAgIHN0eWxlLmV4dGVuZHMoc3VwZXJTdHlsZSk7XG4gICAgICAgIH1cblxuICAgICAgICBzdHlsZU1hcFtjbGFzc05hbWVdID0gc3R5bGU7XG59XG5cbmZ1bmN0aW9uIHJldHJpZXZlU3R5bGUoY2xhc3NOYW1lKSB7XG4gIGNvbnN0IHN0eWxlID0gc3R5bGVNYXBbY2xhc3NOYW1lXSB8fCBudWxsO1xuXG4gIHJldHVybiBzdHlsZTtcbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICByZW5kZXJTdHlsZSxcbiAgcmVuZGVyU3R5bGVzLFxuICBnZW5lcmF0ZVN0eWxlLFxuICByZXRyaWV2ZVN0eWxlXG59O1xuXG5mdW5jdGlvbiByZXRyaWV2ZVN0eWxlc0NTUygpIHtcbiAgY29uc3QgY2xhc3NOYW1lcyA9IE9iamVjdC5rZXlzKHN0eWxlTWFwKSxcbiAgICAgICAgc3R5bGVzQ1NTID0gY2xhc3NOYW1lcy5yZWR1Y2UoKHN0eWxlc0NTUywgY2xhc3NOYW1lKSA9PiB7XG4gICAgICAgICAgY29uc3Qgc3R5bGUgPSByZXRyaWV2ZVN0eWxlKGNsYXNzTmFtZSksXG4gICAgICAgICAgICAgICAgc3R5bGVDU1MgPSBzdHlsZS5hc0NTUyhjbGFzc05hbWUpO1xuXG4gICAgICAgICAgc3R5bGVzQ1NTICs9IHN0eWxlQ1NTO1xuXG4gICAgICAgICAgcmV0dXJuIHN0eWxlc0NTUztcbiAgICAgICAgfSwgXCJcIik7XG5cbiAgcmV0dXJuIHN0eWxlc0NTUztcbn1cbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQ0FBQSxVQUFZOzs7OztBQUVNLEdBQVUsQ0FBVixNQUFVO0FBQ1AsR0FBYyxDQUFkLE1BQWM7QUFDYixHQUFlLENBQWYsT0FBZTs7Ozs7O0FBRXJDLEdBQUssQ0FBQyxRQUFRLEdBSE8sTUFBYyxTQUdULFdBQVcsSUFDL0IsU0FBUyxHQUhPLE9BQWUsU0FHVCxXQUFXO0FBRXZDLEVBQUUsR0FBRyxVQUFVLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDekIsVUFBVSxDQUFDLFFBQVE7O0FBQ3JCLENBQUM7QUFFRCxHQUFLLENBQUcsUUFBUSxHQUFLLFVBQVUsQ0FBdkIsUUFBUTtTQUVQLFdBQVcsQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUMzQixHQUFLLENBQUMsY0FBYyxHQUFHLFFBQVEsQ0FBQyxhQUFhLEVBQUMsSUFBTSxJQUM5QyxlQUFlLEdBQUcsUUFBUSxDQUFDLGFBQWEsRUFBQyxLQUFPLElBQ2hELFNBQVMsSUFBSSxZQUVyQixFQUFRLE1BQUEsQ0FBTixLQUFLO0lBRUwsTUFBTSxDQUFDLE1BQU0sQ0FBQyxlQUFlO1FBQzNCLFNBQVMsRUFBVCxTQUFTOztJQUdYLGNBQWMsQ0FBQyxXQUFXLENBQUMsZUFBZTtBQUM1QyxDQUFDO1NBRVEsWUFBWSxHQUFHLENBQUM7SUFDdkIsR0FBSyxDQUFDLFNBQVMsR0FBRyxpQkFBaUIsSUFDN0IsS0FBSyxHQUFHLFNBQVMsQ0FBRyxDQUFHLEFBQUgsRUFBRyxBQUFILENBQUc7SUFFN0IsV0FBVyxDQUFDLEtBQUs7QUFDbkIsQ0FBQztTQUVRLGFBQWEsQ0FBQyxJQUFJLEVBQUUsU0FBUyxFQUFFLEtBQWlCLEVBQUUsQ0FBQztRQUFwQixVQUFVLEdBQVYsS0FBaUIsY0FBSixJQUFJLEdBQWpCLEtBQWlCO0lBQ3ZELEdBQUssQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLEtBQUssSUFDcEIsT0FBTyxHQUFHLE9BQU8sQ0FBQyxNQUFNLFVBQUUsUUFBTyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUssQ0FBQztRQUNwRCxHQUFLLENBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxLQUFLO1FBRXRCLFFBQU8sR0FBSSxHQUFHLEtBQUssU0FBUyxNQUNILE1BQU0sQ0FBaEIsUUFBTyxFQUFZLE1BQUcsQ0FBWixNQUFNLEVBQU8sTUFBQSxDQUFKLEdBQUcsT0FDVixNQUFNLENBQWhCLFFBQU8sRUFBVSxNQUFBLENBQVAsTUFBTTtlQUUxQixRQUFPO0lBQ2hCLENBQUMsT0FDRCxNQUFNLEdBQUcsUUFBUSxDQUFDLFFBQVEsQ0FBQyxPQUFPLEdBQ2xDLElBQUksR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FDN0IsS0FBSyxHQS9DSyxNQUFVLFNBK0NOLGlCQUFpQixDQUFDLElBQUksRUFBRSxNQUFNO0lBRTVDLEVBQUUsRUFBRSxVQUFVLEtBQUssSUFBSSxFQUFFLENBQUM7UUFDeEIsS0FBSyxDQUFDLE9BQU8sQ0FBQyxVQUFVO0lBQzFCLENBQUM7SUFFRCxRQUFRLENBQUMsU0FBUyxJQUFJLEtBQUs7QUFDbkMsQ0FBQztTQUVRLGFBQWEsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUNqQyxHQUFLLENBQUMsS0FBSyxHQUFHLFFBQVEsQ0FBQyxTQUFTLEtBQUssSUFBSTtXQUVsQyxLQUFLO0FBQ2QsQ0FBQzs7SUFHQyxXQUFXLEVBQVgsV0FBVztJQUNYLFlBQVksRUFBWixZQUFZO0lBQ1osYUFBYSxFQUFiLGFBQWE7SUFDYixhQUFhLEVBQWIsYUFBYTs7O1NBR04saUJBQWlCLEdBQUcsQ0FBQztJQUM1QixHQUFLLENBQUMsVUFBVSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBUSxHQUNqQyxTQUFTLEdBQUcsVUFBVSxDQUFDLE1BQU0sVUFBRSxVQUFTLEVBQUUsU0FBUyxFQUFLLENBQUM7UUFDdkQsR0FBSyxDQUFDLEtBQUssR0FBRyxhQUFhLENBQUMsU0FBUyxHQUMvQixRQUFRLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxTQUFTO1FBRXRDLFVBQVMsSUFBSSxRQUFRO2VBRWQsVUFBUztJQUNsQixDQUFDO1dBRUEsU0FBUztBQUNsQixDQUFDIn0=